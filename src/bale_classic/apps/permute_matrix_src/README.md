# Permute Matrix

This application takes a sparse matrix (see [spmat](../../spmat/README.md) library), a permutation for the rows and a permutation for the columns of the matrix. The goal is to apply the permutations and returned the permuted matrix. A note on the permutations. If row perm is a permutation of the rows, we interpret rowperm[i] = j to mean that row i in the original matrix should go to row j in the permuted matrix. Given this, processors know where rows are destined in the permuted matrix. Also, the nonzeros in a row all go to the same PE (as we observed before, permuting the rows and columns of a matrix does not change the number of nonzeros in each row; those nonzeros are all sent to a different row index and their column indices are relabeled). This application is done in two phases. In phase 1, we shuffle the row data so that the nonzeros for each row land in the correct place in the permuted matrix data structure. This phase looks a little like the histogram application, for each local row, PEs look up the destination of the row and send/write its data to the correct PE. In the second phase, we relabel the column indices on every nonzero in the permuted sparse matrix. This phase looks exactly like indexgather. PEs look at each column index they have locally and request/read its permuted index in the distributed colperm array.

See the spmat_agi.upc file for the simplest implementation of this app.